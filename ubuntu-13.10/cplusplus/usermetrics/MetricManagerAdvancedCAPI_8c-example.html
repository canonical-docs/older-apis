<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>libusermetrics: MetricManagerAdvancedCAPI.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="https://developer.ubuntu.com/api/devel/ubuntu-13.10/cplusplus/usermetrics/jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libusermetrics
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MetricManagerAdvancedCAPI.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>A more advanced metric that updates the history of a metric. Usually this would be a metric from an external data source, e.g. e-mail or Facebook messages.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="usermetricsinput_8h.html">libusermetricsinput/usermetricsinput.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">    <span class="comment">// We start with a manager object.</span></div>
<div class="line">    <span class="comment">// This can be used as a long-lived object to reduce DBus traffic.</span></div>
<div class="line">    <a class="code" href="usermetricsinput_8h.html#a7352ed8164cb4dfee8f0ef9d27d3ebe1" title="A central place for registering user metrics. ">UserMetricsInputMetricManager</a> metricManager =</div>
<div class="line">            <a name="a0"></a><a class="code" href="usermetricsinput_8h.html#af59e1f9c50dcc73755a7b4b07b1aba37" title="Construct a new UserMetricsInputMetricManager. ">usermetricsinput_metricmanager_new</a>();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a parameters object</span></div>
<div class="line">    <a class="code" href="usermetricsinput_8h.html#a34ed483df591648eb3f3118609eae6df" title="Parameters for constructing a metric. ">UserMetricsInputMetricParameters</a> parameters =</div>
<div class="line">            <a name="a1"></a><a class="code" href="usermetricsinput_8h.html#af0f8d6a63b4dee377a84f47f21be7bd3" title="Construct a new UserMetricsInputMetricParameters. ">usermetricsinput_metricparameters_new</a>(<span class="stringliteral">&quot;twitter&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Set its attributes</span></div>
<div class="line">    <a name="a2"></a><a class="code" href="usermetricsinput_8h.html#a07374ef2eef88fddd5bb1f5d6dcec28e" title="Set the string to print in the output API, e.g. &quot;&lt;b&gt;%1&lt;/b&gt; messages received today&quot;. ">usermetricsinput_metricparameters_set_format_string</a>(parameters,</div>
<div class="line">            <span class="stringliteral">&quot;&lt;b&gt;%1&lt;/b&gt; tweets received today&quot;</span>);</div>
<div class="line">    <a name="a3"></a><a class="code" href="usermetricsinput_8h.html#aedf61b9f47b1de80db718059ffe86319" title="set the string to print in the case of no data, e.g. &quot;No messages received today&quot; ...">usermetricsinput_metricparameters_set_empty_data_string</a>(parameters,</div>
<div class="line">            <span class="stringliteral">&quot;No tweets today&quot;</span>);</div>
<div class="line">    <a name="a4"></a><a class="code" href="usermetricsinput_8h.html#ae7fdf9c5fe35a32f58d81876d020c052" title="Set the translation domain. ">usermetricsinput_metricparameters_set_text_domain</a>(parameters,</div>
<div class="line">            <span class="stringliteral">&quot;myapptextdomain&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// You can hold onto this shared object for as long as you want.</span></div>
<div class="line">    <span class="comment">// It will be destroyed when the manager is destroyed.</span></div>
<div class="line">    <a class="code" href="usermetricsinput_8h.html#a1abb7e3afa51177792d0672b4e9769b9" title="A single user metric, e.g. &quot;number of e-mails today&quot; or &quot;photos taken today&quot;. ">UserMetricsInputMetric</a> metric = <a name="a5"></a><a class="code" href="usermetricsinput_8h.html#a1634de4e0e5490b465e8c544074cb0e8" title="Register a new UserMetricsInputMetric. ">usermetricsinput_metricmanager_add</a>(</div>
<div class="line">            metricManager, parameters);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Remember to free the parameters object after use</span></div>
<div class="line">    <a name="a6"></a><a class="code" href="usermetricsinput_8h.html#a1642acbf716986af38a30afbb0dbfb1a" title="Free a UserMetricsInputMetricParameters. ">usermetricsinput_metricparameters_delete</a>(parameters);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The update is sent when the update object is destroyed.</span></div>
<div class="line">    <span class="comment">// Providing a blank username string will use the current</span></div>
<div class="line">    <span class="comment">// user according to the USER environment variable.</span></div>
<div class="line">    <a class="code" href="usermetricsinput_8h.html#a83a29a00021c4e85a2bacd75ad9187e6" title="A update to a user metric for a particular user. ">UserMetricsInputMetricUpdate</a> metricUpdate = <a name="a7"></a><a class="code" href="usermetricsinput_8h.html#a67be82f953e7fd0cbf12356a77c65cfd" title="Create an update to a particular metric. ">usermetricsinput_metric_update</a>(</div>
<div class="line">            metric, <span class="stringliteral">&quot;username&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The data is ordered starting from today, going backwards in time</span></div>
<div class="line">    <a name="a8"></a><a class="code" href="usermetricsinput_8h.html#a74e2f80d61e621e4bd3a2b1a9df3c156" title="Add data to a UserMetricsInputMetricUpdate. ">usermetricsinput_metricupdate_add_data</a>(metricUpdate, 1.0);</div>
<div class="line">    <a class="code" href="usermetricsinput_8h.html#a74e2f80d61e621e4bd3a2b1a9df3c156" title="Add data to a UserMetricsInputMetricUpdate. ">usermetricsinput_metricupdate_add_data</a>(metricUpdate, 0.1);</div>
<div class="line">    <a class="code" href="usermetricsinput_8h.html#a74e2f80d61e621e4bd3a2b1a9df3c156" title="Add data to a UserMetricsInputMetricUpdate. ">usermetricsinput_metricupdate_add_data</a>(metricUpdate, -5.0);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Delete and dispatch the metri update</span></div>
<div class="line">    <a name="a9"></a><a class="code" href="usermetricsinput_8h.html#ada691afb67642066c997ceaff5f7273b" title="Free a UserMetricsInputMetric. ">usermetricsinput_metricupdate_delete</a>(metricUpdate);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Free the manager when done with it</span></div>
<div class="line">    <a name="a10"></a><a class="code" href="usermetricsinput_8h.html#a72fdb8f86e2b0f69b17b68309d733642" title="Free a UserMetricsInputMetricManager. ">usermetricsinput_metricmanager_delete</a>(metricManager);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 3 2013 02:53:07 for libusermetrics by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
