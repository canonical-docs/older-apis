<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Unity Action API: Offline Actions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Unity Action API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Offline Actions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Applications can define offline (jump list) actions in their <em>.desktop</em> files. These actions are available in the Launcher, AppMenu, HUD and MessagingMenu even if the application is not running. When an offline action is executed and the application is not running the application is started and executes the given action on startup, but for the user it does not make any difference if the application is running or not prior to the action invocation. </p>
<hr/>
<p>This example assumes we have a mail application, <em>MailApp</em>. This application defines offline actions in <em>mail-app.desktop</em>: </p>
<div class="fragment"><div class="line">[Desktop Entry]</div>
<div class="line">Encoding=UTF-8</div>
<div class="line">Name=Mail Application</div>
<div class="line">Exec=mail-app %u</div>
<div class="line">Actions=Compose;Contacts</div>
<div class="line"></div>
<div class="line">[Desktop Action Compose]</div>
<div class="line">Name=Compose New Message</div>
<div class="line">OnlyShowIn=Messaging Menu;Unity;</div>
<div class="line">Exec=</div>
<div class="line"></div>
<div class="line">[Desktop Action Contacts]</div>
<div class="line">Name=Contacts</div>
<div class="line">OnlyShowIn=Messaging Menu;Unity;</div>
<div class="line">Exec=</div>
</div><!-- fragment --><p>The desktop file's <em>Actions</em> key lists the offline actions. Each action then has its own group entry in the <em>.desktop</em> file. <em>MailApp</em> defines two offline actions: <em>Compose</em> and <em>Contacts</em>.</p>
<p>By leaving the <em>Exec</em> keys empty for the actions the platform will invoke the Unity Actions defined by the application.</p>
<p>Now, the Application has to define corresponding actions in it's code: </p>
<div class="fragment"><div class="line">    Action *newMessageAction = <span class="keyword">new</span> Action(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// matches the .desktop file Desktop Action identifier</span></div>
<div class="line">    newMessageAction-&gt;setName(<span class="stringliteral">&quot;Compose&quot;</span>);</div>
</div><!-- fragment --><div class="fragment"><div class="line">    Action *openAddressBookAction = <span class="keyword">new</span> Action(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// matches the .desktop file Desktop Action identifier</span></div>
<div class="line">    openAddressBookAction-&gt;setName(<span class="stringliteral">&quot;Contacts&quot;</span>);</div>
</div><!-- fragment --><p> And finally add the actions to the manager. </p>
<div class="fragment"><div class="line">    ActionManager *actionManager = <span class="keyword">new</span> ActionManager(<span class="keyword">this</span>);</div>
<div class="line">    actionManager-&gt;addAction(newMessageAction);</div>
<div class="line">    actionManager-&gt;addAction(openAddressBookAction);</div>
</div><!-- fragment --><hr/>
<p>Here is the full example also showing the connections to the Action::triggered() signal: </p>
<div class="fragment"><div class="line"><span class="comment">/* This file is part of unity-action-api</span></div>
<div class="line"><span class="comment"> * Copyright 2013 Canonical Ltd.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * unity-action-api is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><span class="comment"> * under the terms of the GNU Lesser General Public License version 3,</span></div>
<div class="line"><span class="comment"> * as published by the Free Software Foundation.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * unity-action-api is distributed in the hope that it will be useful, but</span></div>
<div class="line"><span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranties of</span></div>
<div class="line"><span class="comment"> * MERCHANTABILITY, SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR</span></div>
<div class="line"><span class="comment"> * PURPOSE.  See the GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;QMainWindow&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;unity/action/Action&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unity/action/ActionManager&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="classunity_1_1action_1_1Action.html" title="The main action class. ">unity::action::Action</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="classunity_1_1action_1_1ActionManager.html">unity::action::ActionManager</a>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>MailApp : <span class="keyword">public</span> QMainWindow</div>
<div class="line">{</div>
<div class="line">    Q_OBJECT</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    MailApp(QWidget *parent = 0);</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span> slots:</div>
<div class="line">    <span class="keywordtype">void</span> newMessage();</div>
<div class="line">    <span class="keywordtype">void</span> openAddressBook();</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">MailApp::MailApp(QWidget *parent)</div>
<div class="line">    : QMainWindow(parent)</div>
<div class="line">{</div>
<div class="line"></div>
<div class="line">    Action *newMessageAction = <span class="keyword">new</span> Action(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// matches the .desktop file Desktop Action identifier</span></div>
<div class="line">    newMessageAction-&gt;setName(<span class="stringliteral">&quot;Compose&quot;</span>);</div>
<div class="line">    newMessageAction-&gt;setText(tr(<span class="stringliteral">&quot;Compose New Message&quot;</span>));</div>
<div class="line">    newMessageAction-&gt;setKeywords(tr(<span class="stringliteral">&quot;Write New Message;Send New Message&quot;</span>));</div>
<div class="line">    connect(newMessageAction, &amp;<a class="code" href="classunity_1_1action_1_1Action.html#ab9e9c422f68ad9b3bdb3767ae01d274a">Action::triggered</a>, <span class="keyword">this</span>, &amp;MailApp::newMessage);</div>
<div class="line"></div>
<div class="line">    Action *openAddressBookAction = <span class="keyword">new</span> Action(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// matches the .desktop file Desktop Action identifier</span></div>
<div class="line">    openAddressBookAction-&gt;setName(<span class="stringliteral">&quot;Contacts&quot;</span>);</div>
<div class="line">    openAddressBookAction-&gt;setText(tr(<span class="stringliteral">&quot;Open Address Book&quot;</span>));</div>
<div class="line">    connect(openAddressBookAction, &amp;<a class="code" href="classunity_1_1action_1_1Action.html#ab9e9c422f68ad9b3bdb3767ae01d274a">Action::triggered</a>, <span class="keyword">this</span>, &amp;MailApp::openAddressBook);</div>
<div class="line"></div>
<div class="line">    ActionManager *actionManager = <span class="keyword">new</span> ActionManager(<span class="keyword">this</span>);</div>
<div class="line">    actionManager-&gt;addAction(newMessageAction);</div>
<div class="line">    actionManager-&gt;addAction(openAddressBookAction);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MailApp::newMessage()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// show the compose view</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">MailApp::openAddressBook()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// show the address book view</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    QApplication *app = <span class="keyword">new</span> QApplication(argc, argv);</div>
<div class="line">    MailApp mailApp;</div>
<div class="line">    mailApp.show();</div>
<div class="line">    <span class="keywordflow">return</span> app-&gt;exec();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;mail-app.moc&quot;</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 16 2013 09:45:18 for Unity Action API by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
